(this.webpackJsonpreact_app=this.webpackJsonpreact_app||[]).push([[0],{146:function(e,t,a){},265:function(e,t,a){},271:function(e,t){},272:function(e,t){},280:function(e,t){},290:function(e,t){},291:function(e,t){},292:function(e,t){},293:function(e,t){},301:function(e,t){},303:function(e,t,a){"use strict";a.r(t);var n=a(47),r=a.n(n),c=a(237),s=a.n(c),i=(a(265),a(18)),o=a(4),l=a.n(o),u=a(11),d=a(5),f=a(10),h=a(40),b=a(13),v=a(14),j=a(105),p=(a(146),a(39)),g=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={reseted:!0,clicking:!1,above:!1,lastX:-1,lastY:-1},n.draw=n.draw.bind(Object(h.a)(n)),n.setclickflag=n.setclickflag.bind(Object(h.a)(n)),n}return Object(f.a)(a,[{key:"resetCanvas",value:function(){var e=document.querySelector(".Canvas");e.getContext&&(e.getContext("2d").clearRect(0,0,e.width,e.height),console.log("reset!"),this.setState({reseted:!0}))}},{key:"getCanvas",value:function(){return document.querySelector(".Canvas").getContext("2d").canvas}},{key:"setclickflag",value:function(e,t){0===e.nativeEvent.button&&this.setState({clicking:t})}},{key:"draw",value:function(e){var t=e.nativeEvent,a=t.target,n=t.offsetX,r=t.offsetY;if(a.getContext&&this.state.clicking){var c=a.getContext("2d");c.lineWidth=20,c.beginPath(),c.moveTo(this.state.lastX,this.state.lastY),c.lineTo(n,r),c.stroke(),c.arc(this.state.lastX,this.state.lastY,10,0,2*Math.PI),c.arc(n,r,10,0,2*Math.PI),c.fill()}this.setState({reseted:!1,lastX:n,lastY:r})}},{key:"render",value:function(){var e=this;return Object(p.jsx)("canvas",{className:"Canvas",width:450,height:450,onMouseMove:this.draw,onMouseDown:function(t){return e.setclickflag(t,!0)},onMouseUp:function(t){return e.setclickflag(t,!1)},onMouseLeave:function(t){return e.setclickflag(t,!1)}},"canvas")}}]),a}(r.a.Component),O=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={mouseOn:!1},n.changeMouseFlag=n.changeMouseFlag.bind(Object(h.a)(n)),n}return Object(f.a)(a,[{key:"changeMouseFlag",value:function(e){this.setState({mouseOn:e})}},{key:"render",value:function(){var e=this,t=this.state.mouseOn?{backgroundColor:"#ddd"}:{backgroundColor:"#fff"};return Object(p.jsx)("div",{className:"Button",onMouseEnter:function(t){return e.changeMouseFlag(!0)},onMouseLeave:function(t){return e.changeMouseFlag(!1)},onClick:function(t){return e.props.parentFunc(t)},style:t,children:Object(p.jsx)("p",{children:this.props.label})})}}]),a}(r.a.Component),m=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={percent:(0).toFixed(2),barRef:r.a.createRef()},n.visualizePred=n.visualizePred.bind(Object(h.a)(n)),n}return Object(f.a)(a,[{key:"visualizePred",value:function(e){var t=this,a=this.state.barRef.current,n=a.clientWidth,r=a.clientHeight,c=a.parentNode.clientWidth,s=r*(1-e)+c*e;a.animate([{width:n+"px"},{width:s+"px"}],{duration:1e3,fill:"forwards",easing:"cubic-bezier(.44,.01,0,1)"}).onfinish=function(){t.setState({percent:(100*e).toFixed(2)})}}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"PredBar",children:[Object(p.jsx)("div",{className:"PredBarLabel",children:Object(p.jsx)("p",{children:this.props.label})}),Object(p.jsxs)("div",{className:"PercentBarWrap",children:[Object(p.jsx)("div",{className:"PercentBar",ref:this.state.barRef}),Object(p.jsxs)("p",{className:"PredBarValue",children:[this.state.percent,"%"]})]})]})}}]),a}(r.a.Component),x=[{page:"\u3010\u521d\u5fc3\u8005\u3011HTML\u306ecanvas\u3068JavaScript\u3067\u304a\u7d75\u304b\u304d\u30a2\u30d7\u30ea\u4f5c\u308b\u3010\u30d9\u30fc\u30b9\u4f5c\u308a\u7de8\u3011",source:"https://tsuyopon.xyz/2018/09/14/how-to-create-drawing-app-part1/"},{page:"Retrain MobileNet for the web",source:"https://github.com/woudsma/retrain-mobilenet-for-the-web"},{page:"\u3010React\u3011Tensorflow.js \u3092\u4f7f\u7528\u3057\u3066\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u3060\u3051\u3067\u624b\u66f8\u304d\u6587\u5b57\u63a8\u6e2c\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f5c\u6210\u3059\u308b",source:"https://qiita.com/nemutas/items/7826389f7b58bc22607c"}];function k(e){return Object(p.jsxs)("div",{className:"Bunken",children:[Object(p.jsxs)("p",{children:["\u25cb",e.page]}),Object(p.jsxs)("p",{children:["\u3000",Object(p.jsx)("a",{href:e.source,target:"_blank",rel:"noopener noreferrer",children:e.source})]})]})}var C=[{label:0,ref:r.a.createRef()},{label:1,ref:r.a.createRef()},{label:2,ref:r.a.createRef()},{label:3,ref:r.a.createRef()},{label:4,ref:r.a.createRef()},{label:5,ref:r.a.createRef()},{label:6,ref:r.a.createRef()},{label:7,ref:r.a.createRef()},{label:8,ref:r.a.createRef()},{label:9,ref:r.a.createRef()}],w=function(e){Object(b.a)(a,e);var t=Object(v.a)(a);function a(e){var n;Object(d.a)(this,a),(n=t.call(this,e)).state={model:null,is_loaded:!1},n.CanvasRef=r.a.createRef(),n.resetCanvas=n.resetCanvas.bind(Object(h.a)(n)),n.loadModel=n.loadModel.bind(Object(h.a)(n)),n.predict=n.predict.bind(Object(h.a)(n));var c=window.location;return n.loadModel("".concat(c.origin).concat(c.pathname,"/js_tegaki_minimodel/model.json")),n}return Object(f.a)(a,[{key:"loadModel",value:function(){var e=Object(u.a)(l.a.mark((function e(t){var a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.e(t).then((function(e){console.log("model loaded!"),a.setState({model:e,is_loaded:!0,error:"\u306a\u3093\u304b\u66f8\u3044\u3066\u306d"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetCanvas",value:function(e){this.CanvasRef.current.resetCanvas()}},{key:"predict",value:function(e){var t=this;if(!this.state.is_loaded)return this.setState({error:"\u30ed\u30fc\u30c9\u3092\u30df\u30b9\u3063\u305f\u306e\u3067\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u306d"}),0;if(this.CanvasRef.current.state.reseted)return this.setState({error:"\u306a\u3093\u304b\u66f8\u3044\u3066\u306d"}),0;var a=document.createElement("canvas");a.width=28,a.height=28;var n=this.CanvasRef.current.getCanvas(),r=a.getContext("2d");r.drawImage(n,0,0,a.width,a.height);for(var c=r.getImageData(0,0,a.width,a.height),s=0;s<c.data.length;s+=4){var o=c.data[s+3];c.data[s]=c.data[s+1]=c.data[s+2]=o}var l,u=j.g((function(){var e=j.b.fromPixels(c,1);e=j.c(e,255);var a=j.d(e),n=t.state.model.predict(a);return(n=j.f(n)).arraySync()})),d=Object(i.a)(C);try{for(d.s();!(l=d.n()).done;){var f=l.value,h=u[f.label];f.ref.current.visualizePred(h)}}catch(v){d.e(v)}finally{d.f()}var b=j.a(u).arraySync();this.setState({error:"\u78ba\u7387\u304c\u51fa\u305f\u306d "+b+"\u3063\u307d\u3044\u3089\u3057\u3044\u3067\u3059"})}},{key:"render",value:function(){var e=this,t=Object(p.jsx)(g,{ref:this.CanvasRef}),a=C.map((function(e){return Object(p.jsx)(m,{label:e.label,ref:e.ref},e.label+"bar")}));return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)("h1",{children:"\u3057\u305f\u3044\u308f\u306d\u3001\u624b\u66f8\u304d\u6570\u5b57\u8a8d\u8b58(\u5012\u7f6e\u6cd5)"}),Object(p.jsxs)("div",{className:"Step2",children:[Object(p.jsxs)("div",{className:"AppHalf",children:[Object(p.jsxs)("div",{className:"ButtonWrap",children:[Object(p.jsx)(O,{label:"\u30ea\u30bb\u30c3\u30c8",parentFunc:function(t){return e.resetCanvas(t)}}),Object(p.jsx)(O,{label:"\u8a8d\u8b58",parentFunc:function(t){return e.predict(t)}})]}),t]}),Object(p.jsxs)("div",{className:"AppHalf",children:[Object(p.jsx)("p",{children:this.state.error}),a]})]}),Object(p.jsxs)("div",{className:"Step3",children:[Object(p.jsx)("h3",{children:"\u53c2\u8003\u306b\u3057\u305f\u30da\u30fc\u30b8\u3068\u304b"}),x.map((function(e){return Object(p.jsx)(k,{page:e.page,source:e.source})}))]})]})}}]),a}(r.a.Component),y=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,304)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(w,{})}),document.getElementById("root")),y()}},[[303,1,2]]]);
//# sourceMappingURL=main.c3482522.chunk.js.map